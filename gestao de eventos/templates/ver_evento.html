{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2"><i class="bi bi-card-checklist"></i> Detalhes do Evento</h1>
    </div>

    <div class="card shadow-sm">
        <div class="card-header">
            <h4 class="my-0 fw-normal">Detalhes do Evento: {{ evento.nome_evento }}</h4>
        </div>
        <div class="card-body">
            <p><strong>Cliente:</strong> {{ evento.cliente_nome }}</p>
            <p><strong>Data do Evento:</strong> {{ evento.data_evento.strftime('%d/%m/%Y') }}</p>
            <p><strong>Data do Recolhimento:</strong> {{ evento.recolhimento_evento.strftime('%d/%m/%Y') if evento.recolhimento_evento else 'Não especificada' }}</p>
            <p><strong>Status do Evento:</strong> {{ evento.status }}</p>
            
            <!-- Exibindo o Status de Pagamento -->
            <p><strong>Status de Pagamento:</strong>
                {% if evento.status_pagamento == 'Não Registrado' %}
                    <span class="badge bg-secondary-subtle border border-secondary-subtle text-secondary-emphasis rounded-pill">Não Registrado</span>
                {% elif evento.status_pagamento == 'Pendente' %}
                    <span class="badge bg-warning-subtle border border-warning-subtle text-warning-emphasis rounded-pill">Pendente</span>
                {% elif evento.status_pagamento == 'Total' %}
                    <span class="badge bg-success-subtle border border-success-subtle text-success-emphasis rounded-pill">Pago Total</span>
                {% elif evento.status_pagamento == 'Parcial' %}
                    <span class="badge bg-info-subtle border border-info-subtle text-info-emphasis rounded-pill">Pago Parcial</span>
                {% endif %}
            </p>

            <p><strong>Observações:</strong> {{ evento.observacoes or 'Nenhuma observação fornecida.' }}</p>
            
            <h5>Itens do Evento</h5>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Material</th>
                        <th>Quantidade</th>
                        <th>Valor Unitário</th>
                        <th>Valor Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in itens_evento %}
                    <tr>
                        <td>{{ item.nome_material }}</td>
                        <td>{{ item.quantidade }}</td>
                        <td>R$ {{ item.valor_unitario|replace('.', ',') }}</td>
                        <td>R$ {{ (item.valor_unitario * item.quantidade)|replace('.', ',') }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="4" class="text-center">Nenhum item encontrado.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h5>Resumo do Orçamento</h5>
            <table class="table table-bordered">
                <tr>
                    <td><strong>Valor Total dos Itens:</strong></td>
                    <td>R$ {{ valor_total_itens|replace('.', ',') }}</td>
                </tr>
                <tr>
                    <td><strong>Mão de Obra:</strong></td>
                    <td>R$ {{ evento.mao_de_obra|replace('.', ',') }}</td>
                </tr>
                <tr>
                    <td><strong>Frete:</strong></td>
                    <td>R$ {{ evento.frete|replace('.', ',') }}</td>
                </tr>
                <tr>
                    <td><strong>Total Geral:</strong></td>
                    <td>R$ {{ evento.valor_total|replace('.', ',') }}</td>
                </tr>
            </table>

            <a href="{{ url_for('controle_eventos') }}" class="btn btn-primary">Voltar para Controle de Eventos</a>
        </div>
    </div>
</div>
{% endblock %}
